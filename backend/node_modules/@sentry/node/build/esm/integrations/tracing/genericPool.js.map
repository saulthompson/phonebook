{"version":3,"file":"genericPool.js","sources":["../../../../src/integrations/tracing/genericPool.ts"],"sourcesContent":["import { GenericPoolInstrumentation } from '@opentelemetry/instrumentation-generic-pool';\nimport { SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN, defineIntegration, spanToJSON } from '@sentry/core';\nimport type { IntegrationFn } from '@sentry/types';\nimport { generateInstrumentOnce } from '../../otel/instrument';\n\nconst INTEGRATION_NAME = 'GenericPool';\n\nexport const instrumentGenericPool = generateInstrumentOnce(INTEGRATION_NAME, () => new GenericPoolInstrumentation({}));\n\nconst _genericPoolIntegration = (() => {\n  return {\n    name: INTEGRATION_NAME,\n    setupOnce() {\n      instrumentGenericPool();\n    },\n\n    setup(client) {\n      client.on('spanStart', span => {\n        const spanJSON = spanToJSON(span);\n\n        const spanDescription = spanJSON.description;\n\n        // typo in emitted span for version <= 0.38.0 of @opentelemetry/instrumentation-generic-pool\n        const isGenericPoolSpan =\n          spanDescription === 'generic-pool.aquire' || spanDescription === 'generic-pool.acquire';\n\n        if (isGenericPoolSpan) {\n          span.setAttribute(SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN, 'auto.db.otel.generic_pool');\n        }\n      });\n    },\n  };\n}) satisfies IntegrationFn;\n\n/**\n * GenericPool integration\n *\n * Capture tracing data for GenericPool.\n */\nexport const genericPoolIntegration = defineIntegration(_genericPoolIntegration);\n"],"names":[],"mappings":";;;;AAKA,MAAM,gBAAA,GAAmB,aAAa,CAAA;AACtC;MACa,qBAAsB,GAAE,sBAAsB,CAAC,gBAAgB,EAAE,MAAM,IAAI,0BAA0B,CAAC,EAAE,CAAC,EAAC;AACvH;AACA,MAAM,uBAAwB,IAAG,MAAM;AACvC,EAAE,OAAO;AACT,IAAI,IAAI,EAAE,gBAAgB;AAC1B,IAAI,SAAS,GAAG;AAChB,MAAM,qBAAqB,EAAE,CAAA;AAC7B,KAAK;AACL;AACA,IAAI,KAAK,CAAC,MAAM,EAAE;AAClB,MAAM,MAAM,CAAC,EAAE,CAAC,WAAW,EAAE,QAAQ;AACrC,QAAQ,MAAM,QAAS,GAAE,UAAU,CAAC,IAAI,CAAC,CAAA;AACzC;AACA,QAAQ,MAAM,eAAA,GAAkB,QAAQ,CAAC,WAAW,CAAA;AACpD;AACA;AACA,QAAQ,MAAM,iBAAkB;AAChC,UAAU,oBAAoB,qBAAA,IAAyB,eAAA,KAAoB,sBAAsB,CAAA;AACjG;AACA,QAAQ,IAAI,iBAAiB,EAAE;AAC/B,UAAU,IAAI,CAAC,YAAY,CAAC,gCAAgC,EAAE,2BAA2B,CAAC,CAAA;AAC1F,SAAQ;AACR,OAAO,CAAC,CAAA;AACR,KAAK;AACL,GAAG,CAAA;AACH,CAAC,CAAE,EAAA;AACH;AACA;AACA;AACA;AACA;AACA;MACa,sBAAuB,GAAE,iBAAiB,CAAC,uBAAuB;;;;"}